# 애플 로그인

참고 링크

[https://0biglife.tistory.com/entry/애플-소셜-로그인1-invertasereact-native-apple-authentication](https://0biglife.tistory.com/entry/%EC%95%A0%ED%94%8C-%EC%86%8C%EC%85%9C-%EB%A1%9C%EA%B7%B8%EC%9D%B81-invertasereact-native-apple-authentication)

[https://velog.io/@otterji/React-Native-삽질기-5-Apple-로그인-구현하기-iOS](https://velog.io/@otterji/React-Native-%EC%82%BD%EC%A7%88%EA%B8%B0-5-Apple-%EB%A1%9C%EA%B7%B8%EC%9D%B8-%EA%B5%AC%ED%98%84%ED%95%98%EA%B8%B0-iOS)

[https://velog.io/@jinsunee/react-native-firebase-auth를-이용한-apple-로그인-구현하기](https://velog.io/@jinsunee/react-native-firebase-auth%EB%A5%BC-%EC%9D%B4%EC%9A%A9%ED%95%9C-apple-%EB%A1%9C%EA%B7%B8%EC%9D%B8-%EA%B5%AC%ED%98%84%ED%95%98%EA%B8%B0)   [main]

설치 패키지 : `@invertase/react-native-apple-authentication`

필요 패키지: `@react-native-firebase/auth`  (이미 설치 & 설정 되어 있음)

![스크린샷 2024-01-11 오후 3.04.36.png](%E1%84%8B%E1%85%A2%E1%84%91%E1%85%B3%E1%86%AF%20%E1%84%85%E1%85%A9%E1%84%80%E1%85%B3%E1%84%8B%E1%85%B5%E1%86%AB%2019605e7011b44d3dbf334836de675da1/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2024-01-11_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_3.04.36.png)

알림 설정에서 생성한 것을 그대로 사용

![스크린샷 2024-01-11 오후 3.05.05.png](%E1%84%8B%E1%85%A2%E1%84%91%E1%85%B3%E1%86%AF%20%E1%84%85%E1%85%A9%E1%84%80%E1%85%B3%E1%84%8B%E1%85%B5%E1%86%AB%2019605e7011b44d3dbf334836de675da1/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2024-01-11_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_3.05.05.png)

일단 sjsjmine129@gmail.com 으로 설정 → 추후 변경 or 추가가능

![스크린샷 2024-01-11 오후 3.05.40.png](%E1%84%8B%E1%85%A2%E1%84%91%E1%85%B3%E1%86%AF%20%E1%84%85%E1%85%A9%E1%84%80%E1%85%B3%E1%84%8B%E1%85%B5%E1%86%AB%2019605e7011b44d3dbf334836de675da1/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2024-01-11_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_3.05.40.png)

흰 프로젝트에서 추가

![스크린샷 2024-01-11 오후 3.10.14.png](%E1%84%8B%E1%85%A2%E1%84%91%E1%85%B3%E1%86%AF%20%E1%84%85%E1%85%A9%E1%84%80%E1%85%B3%E1%84%8B%E1%85%B5%E1%86%AB%2019605e7011b44d3dbf334836de675da1/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2024-01-11_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_3.10.14.png)

firebase 설정 → apple login 추가

[성공]

```tsx
import {appleAuth} from '@invertase/react-native-apple-authentication';

const LoginWithApple = async () => {
    console.log('Apple 로그인 시도 중 // 아직 미구현!');
    // return; //미작성 코드
    try {
      const appleAuthRequestResponse = await appleAuth.performRequest({
        requestedOperation: appleAuth.Operation.LOGIN,
        requestedScopes: [appleAuth.Scope.EMAIL, appleAuth.Scope.FULL_NAME],
      });

      // Ensure Apple returned a user identityToken
      if (!appleAuthRequestResponse.identityToken) {
        throw 'Apple Sign-In failed - no identify token returned';
      }

      const {identityToken, nonce} = appleAuthRequestResponse;
      console.log('res : ', appleAuthRequestResponse);
      console.log('identityToken: ', identityToken);
      console.log('nonce: ', nonce);
    } catch (error) {
      console.log('에러났으', error);
      // const errorResponse = (error as AxiosError<{message: string}>).response;
      // if (errorResponse?.data.statusCode == 1030) {
      //   console.log('회원가입 진행');
      //   setSignUp(errorResponse?.data.data.signToken);
      // }
    }
  };
```

![Simulator Screenshot - iPhone 15 - 2024-01-11 at 15.43.45.png](%E1%84%8B%E1%85%A2%E1%84%91%E1%85%B3%E1%86%AF%20%E1%84%85%E1%85%A9%E1%84%80%E1%85%B3%E1%84%8B%E1%85%B5%E1%86%AB%2019605e7011b44d3dbf334836de675da1/Simulator_Screenshot_-_iPhone_15_-_2024-01-11_at_15.43.45.png)

![Simulator Screenshot - iPhone 15 - 2024-01-11 at 15.44.00.png](%E1%84%8B%E1%85%A2%E1%84%91%E1%85%B3%E1%86%AF%20%E1%84%85%E1%85%A9%E1%84%80%E1%85%B3%E1%84%8B%E1%85%B5%E1%86%AB%2019605e7011b44d3dbf334836de675da1/Simulator_Screenshot_-_iPhone_15_-_2024-01-11_at_15.44.00.png)

일단 애플 로그인 해서 정보 받아오는것 성공

[return] 첫번째

```json
{
	"authorizationCode": "cb12d008dadef4e45a2a7238cf160729d.0.sxsu.2i_Yg-QD5CSMA0TBRL9_-A",
	"authorizedScopes": [],
	"email": "sjsjmine1@naver.com",
	"fullName": {
		"familyName": "엄",
		"givenName": "승주",
		"middleName": null,
		"namePrefix": null,
		"nameSuffix": null,
		"nickname": null
	},
	"identityToken": "eyJraWQiOiJXNldjT0tCIiwiYWxnIjoiUlMyNTYifQ.eyJpc3MiOiJodHRwczovL2FwcGxlaWQuYXBwbGUuY29tIiwiYXVkIjoib3JnLnJlYWN0anMubmF0aXZlLmV4YW1wbGUudGlucWxlIiwiZXhwIjoxNzA1MDQxODQ3LCJpYXQiOjE3MDQ5NTU0NDcsInN1YiI6IjAwMDcyNC40YzE3ZTE5MTU3Yjk0ZTUzYmRhNWRhYmIwZGE0YmFlMS4wNjQ0Iiwibm9uY2UiOiI4N2E4OGNmMWYwN2MzNmQ5OTZiMjAxMWUzNjNlNWVhYzhkZGJiZWNjMjQzZWUxZGEzMjFhNTBlNzM3OTZkZDFkIiwiY19oYXNoIjoiWEF1Rk1GWUdTSW9tOS05T09OT2pIUSIsImVtYWlsIjoic2pzam1pbmUxQG5hdmVyLmNvbSIsImVtYWlsX3ZlcmlmaWVkIjoidHJ1ZSIsImF1dGhfdGltZSI6MTcwNDk1NTQ0Nywibm9uY2Vfc3VwcG9ydGVkIjp0cnVlLCJyZWFsX3VzZXJfc3RhdHVzIjoyfQ.YEHNKnTMMP95O95U-ZmcIqQ6Wlx8V-bVT7aIY559ey7zU1hP9iay5Hva4u1JISimD9NSv3KJ0xa6XiIQ3jJcv784DOHfMOBKrGbsg2GOgj5lxTbhY5rJYIdsHnsz0CJG-Qu_N30AfFjMjF1TZ_iedhFT3GXLQkY5AyYoPWGD4CD9BGo-wN2uQx-zEvExNvFvON4darU-bOLlQLyw8hXVPBR5-Ygf22s6UfgjU1ObwwS-7iu1D0QnPjS03YEBHXZyloh80YUC6J51jRFKmMWJv1GGBRqWgl3JtemBkyLUK1mrrtWsZyUnrEp4Q2qpkZs4YIOU_kq7McoXc4iGLuAL3g",
	"nonce": "ahAbH0UOgr-pi_RcMD_RRl1khu62CBdt",
	"realUserStatus": 2,
	"state": null,
	"user": "000724.4c17e19157b94e53bda5dabb0da4bae1.0644"
}
```

[return] 두번째

```json
{
	"authorizationCode": "c0cb1fdef7ec148f6b302e2a7649d396a.0.rxsu.RPzy2weZEPOYHjxqUNBFcQ",
	"authorizedScopes": [],
	"email": null,
	"fullName": {
		"familyName": null,
		"givenName": null,
		"middleName": null,
		"namePrefix": null,
		"nameSuffix": null,
		"nickname": null
	},
	"identityToken": "eyJraWQiOiJsVkhkT3g4bHRSIiwiYWxnIjoiUlMyNTYifQ.eyJpc3MiOiJodHRwczovL2FwcGxlaWQuYXBwbGUuY29tIiwiYXVkIjoib3JnLnJlYWN0anMubmF0aXZlLmV4YW1wbGUudGlucWxlIiwiZXhwIjoxNzA1MDQyMTIyLCJpYXQiOjE3MDQ5NTU3MjIsInN1YiI6IjAwMDcyNC40YzE3ZTE5MTU3Yjk0ZTUzYmRhNWRhYmIwZGE0YmFlMS4wNjQ0Iiwibm9uY2UiOiIxZTU5Mzk5MzY0NTMyN2IzNzc0YmE2ZDJjYmI4OTZjYjg2MjcxNDBiYjljNjFlZTIwZmNmYWVmOGY0ZjQxNDNmIiwiY19oYXNoIjoiUEpuUE1fdlltZFZwZmMxbWUzUHVEUSIsImVtYWlsIjoic2pzam1pbmUxQG5hdmVyLmNvbSIsImVtYWlsX3ZlcmlmaWVkIjoidHJ1ZSIsImF1dGhfdGltZSI6MTcwNDk1NTcyMiwibm9uY2Vfc3VwcG9ydGVkIjp0cnVlfQ.VDk_XyBwMsBf6SSDk2m7UFy25SKLRmirj41Yc8G1qf45zKALAK3IibKi-KUgFAjer-rw49zY30GsA2d-M47mbcBnQd0Y7DdTVLGnVgRp9vj-Kt3n2GCEPb6r6Fs51-LU-Ps4c_dv9hXepuM0-YhLoRALd7zZsM8rKn7G2MPapV2IokneqhL-7XhoBJJ3OI9xaCDgfyHNvTYVL9iH9qmX0Dqsmm-LQg-s3K9I9xabgtOf8ta3odENqu965kjwbsTiMakwTTmtnpI3STCTkuqiBkI5ZoZK_UVD8JCxP8shsbHy8MvZqYetwoB-BwjKV_yjWEoLhtraoLPEL0qXP5ASBA",
	"nonce": "uliyz.8VK2BeAUjhpjdhNESR9zevptmd",
	"realUserStatus": 1,
	"state": null,
	"user": "000724.4c17e19157b94e53bda5dabb0da4bae1.0644"
}
```

문제 → 두번째 부터는 정보를 안준다

[https://jwt.io/](https://jwt.io/)

![스크린샷 2024-01-11 오후 4.27.26.png](%E1%84%8B%E1%85%A2%E1%84%91%E1%85%B3%E1%86%AF%20%E1%84%85%E1%85%A9%E1%84%80%E1%85%B3%E1%84%8B%E1%85%B5%E1%86%AB%2019605e7011b44d3dbf334836de675da1/%25E1%2584%2589%25E1%2585%25B3%25E1%2584%258F%25E1%2585%25B3%25E1%2584%2585%25E1%2585%25B5%25E1%2586%25AB%25E1%2584%2589%25E1%2585%25A3%25E1%2586%25BA_2024-01-11_%25E1%2584%258B%25E1%2585%25A9%25E1%2584%2592%25E1%2585%25AE_4.27.26.png)

혹시나 해서 jwt 를 풀어 봤지만 이름 데이터는 없다

email은 있다