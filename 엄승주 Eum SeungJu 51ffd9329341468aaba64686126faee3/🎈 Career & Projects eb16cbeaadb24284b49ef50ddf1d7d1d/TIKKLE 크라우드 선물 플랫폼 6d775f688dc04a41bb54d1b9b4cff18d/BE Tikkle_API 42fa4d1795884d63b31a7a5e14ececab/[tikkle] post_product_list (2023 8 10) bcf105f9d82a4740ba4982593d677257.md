# [tikkle] post_product_list (2023.8.10)

기능 : 토큰 확인

    카테고리, 필터(가격대 위, 아래) , 정렬기준(속성 & 오름,내림), 검색, 몇 번째 로딩인지 까지 해서 가져옴

    가져온 정보들의 오류 확인

    가져온 기준들로 쿼리 실행 & 리턴

## Output

|  | statusCode - detail_code | return |
| --- | --- | --- |
| 성공 | 200 - 00 | const return_body = {
		success: true,
		data: retData,
		detail_code: "00",
		message: "success get product list",
		returnToken: returnToken,
	};
	return res.status(200).send(return_body); |
| 실패 
→ 카테고리 데이터 오류 | 400 - 01 | console.log("post_product_list 에서 에러가 발생했습니다.");
const return_body = {
success: false,
detail_code: "01",
message: "category_id value is null or invalid",
returnToken: null,
};
return res.status(400).send(return_body); |
| 실패 
→ 가격 데이터 오류 | 400 - 02 | console.log("post_product_list 에서 에러가 발생했습니다.");
const return_body = {
success: false,
detail_code: "02",
message: "priceMin or priceMax value is null or invalid",
returnToken: null,
};
return res.status(400).send(return_body); |
| 실패 
→  정렬 속성 데이터 오류 | 400 - 03 | console.log(" post_product_list 에서 에러가 발생했습니다.");
const return_body = {
success: false,
detail_code: "03",
message: "sortAttribute value is null or invalid",
returnToken: null,
};
return res.status(400).send(return_body); |
| 실패 
→ 정렬 방식 데이터 오류 | 400 - 04 | console.log("post_product_list 에서 에러가 발생했습니다.");
const return_body = {
success: false,
detail_code: "04",
message: "sortWay value is null or invalid",
returnToken: null,
};
return res.status(400).send(return_body); |
| 실패 
→ 검색 데이터 오류 | 400 - 05 | console.log("post_product_list 에서 에러가 발생했습니다.");
const return_body = {
success: false,
detail_code: "05",
message: "search value is invalid",
returnToken: null,
};
return res.status(400).send(return_body); |
| 실패 
→ get num 데이터 오류 | 400 - 06 | console.log(" post_product_list 에서 에러가 발생했습니다.");
const return_body = {
success: false,
detail_code: "06",
message: "getNum value is null or invalid",
returnToken: null,
};
return res.status(400).send(return_body); |
|  |  |  |
| 실패 
→ 쿼리 오류 | 500 - 00 | console.log(" post_product_list 에서 에러가 발생했습니다.\n", err);
const return_body = {
success: false,
detail_code: "00",
message: "SQL error",
returnToken: null,
};
return res.status(500).send(return_body); |

TEST

성공

```jsx
const axios = require("axios");
axios.defaults.headers.common['User-Agent'] = 'Tickle/1.0.0 (ReactNative; HwAzefScFOQ0kSJ)';

async function fetchData() {
	try {
		const response = await axios.post(
			"https://frrk5g3voe.execute-api.ap-northeast-2.amazonaws.com/dev/post_product_list",
			{
				category_id: 1,
				priceMin: 6000,
				priceMax: null,
				sortAttribute: "price",
				sortWay: "DESC",
				search: null,
				getNum: 1,
			},
			{
				headers: {
					authorization:
						"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6NSwiaWF0IjoxNjkwNTIwNzQ2LCJleHAiOjE2OTA1MjE2NDYsImlzcyI6IkxpRm9saSJ9.w-4NVe-YbhdeXUPKmiZpOZMi8it_FmwNp3jrbIYh4ME,eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6NSwiaWF0IjoxNjkwNTIwNzQ2LCJleHAiOjE2OTMxMTI3NDYsImlzcyI6IkxpRm9saSJ9.Cl7fT5xT3VxAwpL7QbL8k7z9vaFkaWXr6iDlgReYo0o",
				},
			}
		);
		// Ensure data exists before logging it
		if (response && response.data) {
			console.log(response.data);
		} else {
			console.log("Response or response data is undefined");
		}
	} catch (error) {
    if (error.response && error.response.status) {
      console.error("[status code] ", error.response.status);
    }
    if (error.response && error.response.data) {
      console.error("response data : ", error.response.data);
    }
  }
}

fetchData();
```

성공2

```jsx
const axios = require("axios");
axios.defaults.headers.common['User-Agent'] = 'Tickle/1.0.0 (ReactNative; HwAzefScFOQ0kSJ)';

async function fetchData() {
	try {
		const response = await axios.post(
			"https://frrk5g3voe.execute-api.ap-northeast-2.amazonaws.com/dev/post_product_list",
			{
				category_id: 1,
				priceMin: 6000,
				priceMax: null,
				sortAttribute: "price",
				sortWay: "DESC",
				search: null,
				getNum: 3,
			},
			{
				headers: {
					authorization:
						"eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6NSwiaWF0IjoxNjkwNTIwNzQ2LCJleHAiOjE2OTA1MjE2NDYsImlzcyI6IkxpRm9saSJ9.w-4NVe-YbhdeXUPKmiZpOZMi8it_FmwNp3jrbIYh4ME,eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpZCI6NSwiaWF0IjoxNjkwNTIwNzQ2LCJleHAiOjE2OTMxMTI3NDYsImlzcyI6IkxpRm9saSJ9.Cl7fT5xT3VxAwpL7QbL8k7z9vaFkaWXr6iDlgReYo0o",
				},
			}
		);
		// Ensure data exists before logging it
		if (response && response.data) {
			console.log(response.data);
		} else {
			console.log("Response or response data is undefined");
		}
	} catch (error) {
    if (error.response && error.response.status) {
      console.error("[status code] ", error.response.status);
    }
    if (error.response && error.response.data) {
      console.error("response data : ", error.response.data);
    }
  }
}

fetchData();
```