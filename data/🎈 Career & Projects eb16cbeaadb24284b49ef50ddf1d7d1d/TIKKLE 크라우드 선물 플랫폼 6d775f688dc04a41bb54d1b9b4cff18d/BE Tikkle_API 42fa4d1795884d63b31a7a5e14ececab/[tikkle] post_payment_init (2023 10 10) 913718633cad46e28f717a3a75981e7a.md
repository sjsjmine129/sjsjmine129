# [tikkle] post_payment_init (2023.10.10)

기능 :  구매시도 전에 데이터 베이스에 정보 미리 저장

params : tikkleAction → “sendtikkle” or “buymytikkle”

input : 

```
"body": {
		"tikkling_id":16, 
		"tikkle_quantity":2, 
		"message":"happy!",
	}
```

## Output

|  | statusCode | return |
| --- | --- | --- |
| 성공 | 200 - 00 | return res.status(200).send(Response.create(true, "00", "결제 데이터 저장 완료", payment_param, returnToken)); |
|  |  |  |
|  |  |  |
| 실패
→ Params 오류 | 403-00 | throw new ExpectedError({
status: "403",
message: 잘못된 요청, 해당 기능을 찾을 수 없습니다.,
detail_code: "00",
}); |
| 실패 남 티클링
→ 티클링 진행중 아님 | 403-01 | throw new ExpectedError({
status: "403",
message: 티클링이 진행중이 아닙니다.,
detail_code: "01",
}); |
| 실패  남 티클링
→ 티클링 수량 초과 | 403-02 | throw new ExpectedError({
status: "403",
message: 티클을 받을 수 있는 수량을 초과하였습니다.,
detail_code: "02",
}); |
| 실패 내 티클링
→ 티클링 초과 | 403-01 | throw new ExpectedError({
status: "403",
message: 이미 모든 티클을 수집한 티클링입니다.,
detail_code: "01",
}); |
| 실패 내 티클링
→ 티클링 종료 | 403-02 | throw new ExpectedError({
status: "403",
message: 비정상적 요청, 아직 티클링이 종료되지 않았거나 이미 종료되었습니다.,
detail_code: "02",
}); |
| 실패 내 티클링
→ 내 티클링이 아님 | 403-00 | throw new ExpectedError({
status: "403",
message: 비정상적 요청, 해당 티클링의 소유자가 아닙니다.,
detail_code: "00",
}); |
| 실패
→ 존재하지 않는 티클링 | 404-00 | throw new ExpectedError({
status: "404",
message: 비정상적 요청, 티클링이 존재하지 않습니다.,
detail_code: "00",
}); |
| 실패
→ 서버오류 | 500-00 | return res.status(500).send(Response.create(false, "00", "서버 에러")); |